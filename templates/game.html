<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>Spyfall - Hra</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style-game.css') }}">
</head>
<body>
    <header class="page-header">
        <a href="{{ url_for('home') }}">
            <img src="{{ url_for('static', filename='images/logo.jpeg') }}" alt="Logo" class="logo-img">
        </a>
        <a href="{{ url_for('rules') }}">
            <img src="{{ url_for('static', filename='images/rules.jpeg') }}" alt="Pravidla" class="rules-img">
        </a>
    </header>

    <h1>Hern√≠ m√≠stnost: {{ room_code }}</h1>

    {% if is_spy %}
        <h2>SPY!</h2>
        <img src="{{ url_for('static', filename='images/spy.jpeg') }}" alt="Spy" width="300">

        <h3>Seznam mo≈æn√Ωch lokac√≠:</h3>
        <div class="locations-grid">
            {% for loc in all_locations %}
                <div class="location-item" data-location="{{ loc.name }}">
                    <img src="{{ url_for('static', filename='images/' ~ loc.image) }}" alt="{{ loc.name }}">
                    <p>{{ loc.name }}</p>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <h2>Find who is the spy üëÄ! Lokace: {{ location.name }}</h2>
        <img src="{{ url_for('static', filename='images/' ~ location.image) }}" alt="Lokace" width="300">
    {% endif %}

    <p>Zb√Ωvaj√≠c√≠ ƒças:
        <span id="countdown"
              data-timer="{{ room.timer }}"
              data-paused="{{ room.paused|lower }}">
        </span>
    </p>

    {% if session['username'] == room.host %}
        <form action="/pause_game" method="post" style="display:inline-block;">
            <input type="hidden" name="room_code" value="{{ room_code }}">
            <button type="submit">
                {% if room.paused %}Pokraƒçovat{% else %}Pauza{% endif %}
            </button>
        </form>

        <form action="/end_game" method="post" style="display:inline-block;">
            <input type="hidden" name="room_code" value="{{ room_code }}">
            <button type="submit">Ukonƒçit hru</button>
        </form>
    {% endif %}

    <form id="endGameForm">
        <input type="hidden" name="room_code" value="{{ room_code }}">
        <button type="button" onclick="showGameOverPopup()">Zobrazit v√Ωsledek</button>
    </form>

    <div id="popup" style="display:none; position:fixed; top:20%; left:50%; transform:translateX(-50%);
                          background:white; border:2px solid black; padding:20px; z-index:1000;">
        <h3>Konec hry</h3>
        <p><strong>≈†pi√≥n:</strong> <span id="popupSpy"></span></p>
        <p><strong>Lokace:</strong> <span id="popupLocation"></span></p>
        <form action="/room" method="get">
            <input type="hidden" name="room_code" value="{{ room_code }}">
            <button type="submit">Zpƒõt do m√≠stnosti</button>
        </form>
    </div>

    <!-- JavaScript soubory -->
    <script src="{{ url_for('static', filename='js/game-over-popup.js') }}"></script>
    <script src="{{ url_for('static', filename='js/timer.js') }}"></script>
    <script src="{{ url_for('static', filename='js/location-crossing.js') }}"></script>
</body>
</html>